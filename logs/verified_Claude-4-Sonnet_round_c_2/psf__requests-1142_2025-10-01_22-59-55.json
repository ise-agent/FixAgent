{
  "zero_patches": {
    "Location 1 (/root/hy/projects/requests/requests/models.py lines 388-395)": "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
    "Location 2 (/root/hy/projects/requests/requests/models.py lines 383-383)": "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
    "Location 3 (/root/hy/projects/requests/requests/models.py lines 411-411)": "\ndef prepare_content_length(self, body):\n    \"\"\"Prepare Content-Length header for the request.\n    \n    Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body.\n    \"\"\"\n    # Don't set Content-Length for methods that typically don't have bodies\n    if (hasattr(self, 'method') and self.method and \n        self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and \n        body is None):\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n"
  },
  "variant_patches": {
    "Location 1 (/root/hy/projects/requests/requests/models.py lines 388-395)": [
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n            \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
      "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n"
    ],
    "Location 2 (/root/hy/projects/requests/requests/models.py lines 383-383)": [
      "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
      "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n            return\n        \n        self.headers['Content-Length'] = '0'\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n        elif body is not None:\n            self.headers['Content-Length'] = str(len(body))\n",
      "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n"
    ],
    "Location 3 (/root/hy/projects/requests/requests/models.py lines 411-411)": [
      "\n    def prepare_content_length(self, body):\n        if body is not None:\n            self.headers['Content-Length'] = str(len(body))\n        elif hasattr(body, 'read'):\n            self.headers['Content-Length'] = str(self._get_file_size(body))\n        elif self.method and self.method.upper() not in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n            self.headers['Content-Length'] = '0'\n\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n",
      "\ndef prepare_content_length(self, body):\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        if body is not None:\n            self.headers['Content-Length'] = str(len(body))\n        elif hasattr(body, 'read'):\n            self.headers['Content-Length'] = str(self._get_file_size(body))\n        elif self.method and self.method.upper() not in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n            self.headers['Content-Length'] = '0'\n\n        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n            body.seek(0, 2)\n            self.headers['Content-Length'] = str(body.tell())\n            body.seek(0, 0)\n",
      "\ndef prepare_content_length(self, body):\n    \"\"\"Prepare Content-Length header.\"\"\"\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\ndef prepare_content_length(self, body):\n    \"\"\"Prepare Content-Length header.\"\"\"\n    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n        return\n    \n    self.headers['Content-Length'] = '0'\n    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n        body.seek(0, 2)\n        self.headers['Content-Length'] = str(body.tell())\n        body.seek(0, 0)\n    elif body is not None:\n        self.headers['Content-Length'] = str(len(body))\n",
      "\n    def prepare_content_length(self, body):\n        if body is not None:\n            self.headers['Content-Length'] = str(len(body))\n        elif hasattr(body, 'read'):\n            self.headers['Content-Length'] = str(self._get_file_size(body))\n        elif self.method and self.method.upper() not in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n            self.headers['Content-Length'] = '0'\n",
      "\n    def prepare_content_length(self, body):\n        if body is not None:\n            self.headers['Content-Length'] = str(len(body))\n        elif hasattr(body, 'read'):\n            self.headers['Content-Length'] = str(self._get_file_size(body))\n        else:\n            # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n            if hasattr(self, 'method') and self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n                return\n            self.headers['Content-Length'] = '0'\n",
      "\n    def prepare_content_length(self, body):\n        if body is not None:\n            self.headers['Content-Length'] = str(len(body))\n        elif hasattr(body, 'read'):\n            self.headers['Content-Length'] = str(self._get_file_size(body))\n        elif self.method and self.method.upper() not in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n            self.headers['Content-Length'] = '0'\n"
    ]
  },
  "combined_diffs": {
    "raw_patch": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..c9b9d35c 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,18 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n+\n             if (content_type) and (not 'content-type' in self.headers):\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,6 +414,7 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n+\n             self.prepare_content_length(self.body)\n \n     def prepare_cookies(self, cookies):\n",
    "variant_0": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..c736910a 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,29 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,7 +425,25 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+def prepare_content_length(self, body):\n+    \"\"\"Prepare Content-Length header for the request.\n+    \n+    Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body.\n+    \"\"\"\n+    # Don't set Content-Length for methods that typically don't have bodies\n+    if (hasattr(self, 'method') and self.method and \n+        self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and \n+        body is None):\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n",
    "variant_1": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..6cdfa202 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,29 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,7 +425,19 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+    def prepare_content_length(self, body):\n+        if body is not None:\n+            self.headers['Content-Length'] = str(len(body))\n+        elif hasattr(body, 'read'):\n+            self.headers['Content-Length'] = str(self._get_file_size(body))\n+        elif self.method and self.method.upper() not in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n+            self.headers['Content-Length'] = '0'\n+\n+        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+            body.seek(0, 2)\n+            self.headers['Content-Length'] = str(body.tell())\n+            body.seek(0, 0)\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n",
    "variant_2": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..edb81d3f 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,29 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+    def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n+        self.headers['Content-Length'] = '0'\n+        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+            body.seek(0, 2)\n+            self.headers['Content-Length'] = str(body.tell())\n+            body.seek(0, 0)\n+        elif body is not None:\n+            self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,7 +425,19 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n",
    "variant_3": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..6cdfa202 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,29 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,7 +425,19 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+    def prepare_content_length(self, body):\n+        if body is not None:\n+            self.headers['Content-Length'] = str(len(body))\n+        elif hasattr(body, 'read'):\n+            self.headers['Content-Length'] = str(self._get_file_size(body))\n+        elif self.method and self.method.upper() not in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n+            self.headers['Content-Length'] = '0'\n+\n+        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+            body.seek(0, 2)\n+            self.headers['Content-Length'] = str(body.tell())\n+            body.seek(0, 0)\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n",
    "variant_4": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..741376bc 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,29 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+    def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n+        self.headers['Content-Length'] = '0'\n+        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+            body.seek(0, 2)\n+            self.headers['Content-Length'] = str(body.tell())\n+            body.seek(0, 0)\n+        elif body is not None:\n+            self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+            \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,7 +425,20 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+def prepare_content_length(self, body):\n+    \"\"\"Prepare Content-Length header.\"\"\"\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n",
    "variant_5": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..9726c275 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,29 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,7 +425,20 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+def prepare_content_length(self, body):\n+    \"\"\"Prepare Content-Length header.\"\"\"\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n",
    "variant_6": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..a69373f5 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,29 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,7 +425,14 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+    def prepare_content_length(self, body):\n+        if body is not None:\n+            self.headers['Content-Length'] = str(len(body))\n+        elif hasattr(body, 'read'):\n+            self.headers['Content-Length'] = str(self._get_file_size(body))\n+        elif self.method and self.method.upper() not in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n+            self.headers['Content-Length'] = '0'\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n",
    "variant_7": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..95db3ea6 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,19 +380,36 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n-    def prepare_content_length(self, body):\n-        self.headers['Content-Length'] = '0'\n-        if hasattr(body, 'seek') and hasattr(body, 'tell'):\n-            body.seek(0, 2)\n-            self.headers['Content-Length'] = str(body.tell())\n-            body.seek(0, 0)\n-        elif body is not None:\n-            self.headers['Content-Length'] = str(len(body))\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n \n     def prepare_auth(self, auth):\n         \"\"\"Prepares the given HTTP auth data.\"\"\"\n@@ -408,7 +425,17 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+    def prepare_content_length(self, body):\n+        if body is not None:\n+            self.headers['Content-Length'] = str(len(body))\n+        elif hasattr(body, 'read'):\n+            self.headers['Content-Length'] = str(self._get_file_size(body))\n+        else:\n+            # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+            if hasattr(self, 'method') and self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n+                return\n+            self.headers['Content-Length'] = '0'\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n",
    "variant_8": "diff --git a/requests/models.py b/requests/models.py\nindex 99260453..a69373f5 100644\n--- a/requests/models.py\n+++ b/requests/models.py\n@@ -380,12 +380,29 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.prepare_content_length(body)\n \n             # Add content-type if it wasn't explicitly provided.\n-            if (content_type) and (not 'content-type' in self.headers):\n+\n+def prepare_content_length(self, body):\n+    # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+    if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+        return\n+    \n+    self.headers['Content-Length'] = '0'\n+    if hasattr(body, 'seek') and hasattr(body, 'tell'):\n+        body.seek(0, 2)\n+        self.headers['Content-Length'] = str(body.tell())\n+        body.seek(0, 0)\n+    elif body is not None:\n+        self.headers['Content-Length'] = str(len(body))\n                 self.headers['Content-Type'] = content_type\n \n         self.body = body\n \n+\n     def prepare_content_length(self, body):\n+        # Don't set Content-Length for GET, HEAD, OPTIONS, DELETE when no body\n+        if self.method and self.method.upper() in ('GET', 'HEAD', 'OPTIONS', 'DELETE') and body is None:\n+            return\n+        \n         self.headers['Content-Length'] = '0'\n         if hasattr(body, 'seek') and hasattr(body, 'tell'):\n             body.seek(0, 2)\n@@ -408,7 +425,14 @@ class PreparedRequest(RequestEncodingMixin, RequestHooksMixin):\n             self.__dict__.update(r.__dict__)\n \n             # Recompute Content-Length\n-            self.prepare_content_length(self.body)\n+\n+    def prepare_content_length(self, body):\n+        if body is not None:\n+            self.headers['Content-Length'] = str(len(body))\n+        elif hasattr(body, 'read'):\n+            self.headers['Content-Length'] = str(self._get_file_size(body))\n+        elif self.method and self.method.upper() not in ('GET', 'HEAD', 'OPTIONS', 'DELETE'):\n+            self.headers['Content-Length'] = '0'\n \n     def prepare_cookies(self, cookies):\n         \"\"\"Prepares the given HTTP cookie data.\"\"\"\n"
  }
}
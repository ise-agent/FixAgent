{
  "zero_patches": {
    "Location 1 (/root/hy/projects_2/xarray/xarray/core/dataarray.py lines 1961-1967)": "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n",
    "Location 2 (/root/hy/projects_2/xarray/xarray/core/dataarray.py lines 1953-1960)": "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n"
  },
  "variant_patches": {
    "Location 1 (/root/hy/projects_2/xarray/xarray/core/dataarray.py lines 1961-1967)": [
      "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n",
      "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n",
      "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n",
      "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n",
      "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n",
      "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n",
      "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n",
      "\n        # pull variables out of datarray\n        data_dict = {}\n        for k in variables:\n            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n\n        # unstacked dataset\n        return Dataset(data_dict)\n"
    ],
    "Location 2 (/root/hy/projects_2/xarray/xarray/core/dataarray.py lines 1953-1960)": [
      "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n",
      "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n",
      "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n",
      "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n",
      "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n",
      "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n",
      "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n",
      "\n        idx = self.indexes[dim]\n        if not isinstance(idx, pd.MultiIndex):\n            raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n\n        level_number = idx._get_level_number(level)\n        variables = idx.levels[level_number]\n        variable_dim = idx.names[level_number]\n"
    ]
  },
  "combined_diffs": {
    "raw_patch": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..5ee9a7ca 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1960,11 +1961,21 @@ class DataArray(AbstractArray, DataWithCoords):\n \n         # pull variables out of datarray\n         data_dict = {}\n+        coords_dict = {}\n+        \n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n-\n-        # unstacked dataset\n-        return Dataset(data_dict)\n+            selected = self.sel({variable_dim: k})\n+            # Use squeeze(drop=False) to preserve coordinates\n+            squeezed = selected.squeeze(drop=False)\n+            data_dict[k] = squeezed\n+            \n+            # Collect coordinates that are not the variable_dim\n+            for coord_name, coord_value in squeezed.coords.items():\n+                if coord_name != variable_dim and coord_name not in coords_dict:\n+                    coords_dict[coord_name] = coord_value\n+\n+        # unstacked dataset with proper coordinates\n+        return Dataset(data_dict, coords=coords_dict)\n \n     def transpose(self, *dims: Hashable, transpose_coords: bool = True) -> \"DataArray\":\n         \"\"\"Return a new DataArray object with transposed dimensions.\n",
    "variant_0": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n",
    "variant_1": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n",
    "variant_2": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n",
    "variant_3": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n",
    "variant_4": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n",
    "variant_5": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n",
    "variant_6": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n",
    "variant_7": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n",
    "variant_8": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..c3e8d280 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1950,6 +1950,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         Dataset.to_stacked_array\n         \"\"\"\n \n+\n         idx = self.indexes[dim]\n         if not isinstance(idx, pd.MultiIndex):\n             raise ValueError(f\"'{dim}' is not a stacked coordinate\")\n@@ -1961,7 +1962,7 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=False)\n \n         # unstacked dataset\n         return Dataset(data_dict)\n"
  }
}